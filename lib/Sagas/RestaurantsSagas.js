var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:true});exports.getRestaurants=getRestaurants;exports.updateSearchQuery=updateSearchQuery;exports.watchUpdateSearchQuery=watchUpdateSearchQuery;var _regenerator=_interopRequireDefault(require("@babel/runtime/regenerator"));var _effects=require("redux-saga/effects");var _RestaurantsRedux=_interopRequireDefault(require("../Redux/RestaurantsRedux.js"));var _marked=_regenerator.default.mark(getRestaurants),_marked2=_regenerator.default.mark(updateSearchQuery),_marked3=_regenerator.default.mark(watchUpdateSearchQuery);function getRestaurants(api,action){var _payload,response,restaurants;return _regenerator.default.wrap(function getRestaurants$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_payload=action.payload;_context.next=4;return(0,_effects.call)(api.getRestaurants,_payload);case 4:response=_context.sent;if(!response.ok){_context.next=11;break;}restaurants=response.data.restaurants;_context.next=9;return(0,_effects.put)(_RestaurantsRedux.default.getRestaurantsSuccess(restaurants));case 9:_context.next=13;break;case 11:_context.next=13;return(0,_effects.put)(_RestaurantsRedux.default.getRestaurantsFailure('Connection problems :('));case 13:_context.next=19;break;case 15:_context.prev=15;_context.t0=_context["catch"](0);_context.next=19;return(0,_effects.put)(_RestaurantsRedux.default.getRestaurantsFailure(_context.t0.message));case 19:case"end":return _context.stop();}}},_marked,null,[[0,15]]);}function updateSearchQuery(action){var searchQuery;return _regenerator.default.wrap(function updateSearchQuery$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;searchQuery=action.payload.searchQuery;if(!searchQuery){_context2.next=5;break;}_context2.next=5;return(0,_effects.put)(_RestaurantsRedux.default.updateSearchQuery(searchQuery));case 5:_context2.next=11;break;case 7:_context2.prev=7;_context2.t0=_context2["catch"](0);_context2.next=11;return(0,_effects.put)(_RestaurantsRedux.default.updateSearchQueryFailure(_context2.t0.message));case 11:case"end":return _context2.stop();}}},_marked2,null,[[0,7]]);}function watchUpdateSearchQuery(api,action){var response,restaurants;return _regenerator.default.wrap(function watchUpdateSearchQuery$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;if(!(action.payload.length>1)){_context3.next=17;break;}_context3.next=4;return(0,_effects.put)(_RestaurantsRedux.default.getRestaurantsRequestBySearch());case 4:_context3.next=6;return(0,_effects.delay)(1000);case 6:_context3.next=8;return(0,_effects.call)(api.getRestaurantsByQuery,payload);case 8:response=_context3.sent;if(!response.ok){_context3.next=15;break;}restaurants=response.data.restaurants;_context3.next=13;return(0,_effects.put)(_RestaurantsRedux.default.getRestaurantsSuccess(restaurants));case 13:_context3.next=17;break;case 15:_context3.next=17;return(0,_effects.put)(_RestaurantsRedux.default.getRestaurantsFailure('Connection problems :('));case 17:_context3.next=23;break;case 19:_context3.prev=19;_context3.t0=_context3["catch"](0);_context3.next=23;return(0,_effects.put)(_RestaurantsRedux.default.getRestaurantsFailure('Connection problems :('));case 23:case"end":return _context3.stop();}}},_marked3,null,[[0,19]]);}